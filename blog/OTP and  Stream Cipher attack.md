# ***OTP and Stream Cipher Attack***

### [Coursera课程视频](https://www.coursera.org/learn/crypto/lecture/euFJx/attacks-on-stream-ciphers-and-the-one-time-pad)

## ***1. 两次同一密码本攻击***

一次性密码本和流密码在使用时密钥只能使用一次。***This is why it's called one time pad.*** 

若有两条消息使用了统一***key***加密，则会被完全破解：

<b><i>
c1 = E(m1,PRG(k))

c2 = E(m2,PRG(k))

attack:

c1 xor c2 = m1 xor m2
</i></b>

根据两段明文的异或可以还原出两个完整的明文,设a、b、c都是二进制数:
<b><i>

a xor b = c

a xor c = b

b xor c = a
</i></b>

可以将两段密文进行异或运算，得到一个结果，然后再用这个结果与其中一段密文进行异或，就能得到另一段密文的明文。

***一些例子***

- ***网络通信--点对点传输协议PPTP***

客户端向服务器发起请求，客户端和服务器使用同一个密钥，他们互相传递消息。把客户端发送的消息称为***m1***。PPTP的工作方式是：在整个交互中，从客户端到服务器被视作一个流，也就是说消息 ***m1 m2 m3*** 被视作一个长长的流。

服务器端也采用了同样的方法，也就是说所有从服务器发出的消息同样被视为一个长长的流。并且使用了同一个随机数种子加密，使用了同一个流加密的密钥，这是危险的！

所以，***应该用一个密钥来加密客户端和服务器之间的交互，使用另一个密钥来加密服务器和客户端之间的交互。***

- ***Disk Encryption***

用户的文件在写入磁盘后会被加密，可是当用户更改文件内容并再次写入磁盘时，会使用同一密钥进行加密。因此攻击者会得到两段不同的密文（对应的密钥一致），从而造成泄露。

***所以磁盘加密不能使用流加密。***

## ***2. No Integrity(不完整性)***

***OTP***具有***延展性***，即攻击者可以修改密文(***xor something***),从而解密后不能得到正确的明文，所以由于***OTP***的不完整性，不能抵挡修改密文的攻击。

完美安全性（完善保密性）只能抵挡唯密文攻击，不能抵挡其他攻击（如选择明文攻击等）。

而一次一密既具有完善保密性（可抵挡唯密文攻击），也具有语义安全性（可抵挡选择明文攻击）。
